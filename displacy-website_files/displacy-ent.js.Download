"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var displaCyENT=function(){function displaCyENT(api,options){_classCallCheck(this,displaCyENT);this.api=api;this.container=document.querySelector(options.container||"#displacy");this.defaultText=options.defaultText||"When Sebastian Thrun started working on self-driving cars at Google in 2007, few people outside of the company took him seriously.";this.defaultModel=options.defaultModel||"en";this.defaultEnts=options.defaultEnts||["person","org","gpe","loc","product"];this.onStart=options.onStart||false;this.onSuccess=options.onSuccess||false;this.onError=options.onError||false;this.onRender=options.onRender||false}_createClass(displaCyENT,[{key:"parse",value:function parse(){var text=arguments.length<=0||arguments[0]===undefined?this.defaultText:arguments[0];var _this=this;var model=arguments.length<=1||arguments[1]===undefined?this.defaultModel:arguments[1];var ents=arguments.length<=2||arguments[2]===undefined?this.defaultEnts:arguments[2];if(typeof this.onStart==="function")this.onStart();var xhr=new XMLHttpRequest;xhr.open("POST",this.api,true);xhr.setRequestHeader("Content-type","text/plain");xhr.onreadystatechange=function(){if(xhr.readyState===4&&xhr.status===200){if(typeof _this.onSuccess==="function")_this.onSuccess();_this.render(text,JSON.parse(xhr.responseText),ents)}else if(xhr.status!==200){if(typeof _this.onError==="function")_this.onError(xhr.statusText)}};xhr.onerror=function(){xhr.abort();if(typeof _this.onError==="function")_this.onError()};xhr.send(JSON.stringify({text:text,model:model}))}},{key:"render",value:function render(text,spans,ents){var _this2=this;this.container.innerHTML="";var offset=0;spans.forEach(function(_ref){var type=_ref.type;var start=_ref.start;var end=_ref.end;var entity=text.slice(start,end);var fragments=text.slice(offset,start).split("\n");fragments.forEach(function(fragment,i){_this2.container.appendChild(document.createTextNode(fragment));if(fragments.length>1&&i!=fragments.length-1)_this2.container.appendChild(document.createElement("br"))});if(ents.includes(type.toLowerCase())){var mark=document.createElement("mark");mark.setAttribute("data-entity",type.toLowerCase());mark.appendChild(document.createTextNode(entity));_this2.container.appendChild(mark)}else{_this2.container.appendChild(document.createTextNode(entity))}offset=end});this.container.appendChild(document.createTextNode(text.slice(offset,text.length)));console.log('%cðŸ’¥  HTML markup\n%c<div class="entities">'+this.container.innerHTML+"</div>","font: bold 16px/2 arial, sans-serif",'font: 13px/1.5 Consolas, "Andale Mono", Menlo, Monaco, Courier, monospace');if(typeof this.onRender==="function")this.onRender()}}]);return displaCyENT}();